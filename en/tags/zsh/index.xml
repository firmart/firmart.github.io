<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" 
  xmlns:content="http://purl.org/rss/1.0/modules/content/" 
  xmlns:dc="http://purl.org/dc/elements/1.1/" 
  xmlns:atom="http://www.w3.org/2005/Atom" 
  xmlns:sy="http://purl.org/rss/1.0/modules/syndication/" 
  xmlns:media="http://search.yahoo.com/mrss/">
  <channel>
    <title>zsh on Firmin Martin</title>
    <link>https://firminmartin.com/en/tags/zsh/</link>
    <description>Recent content in zsh on Firmin Martin</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en</language>
    <copyright>©2021, All Rights Reserved</copyright>
    <lastBuildDate>Thu, 20 May 2021 00:00:00 +0200</lastBuildDate>
    <sy:updatePeriod>weekly</sy:updatePeriod>
    
        <atom:link href="https://firminmartin.com/en/tags/zsh/index.xml" rel="self" type="application/rss+xml" />
    

      
      <item>
        <title>Git: autocomplete –trailer and –cc in zsh</title>
        <link>https://firminmartin.com/en/posts/2021/05/git_autocomplete_trailer_and_recipients_in_zsh/</link>
        <pubDate>Thu, 20 May 2021 00:00:00 +0200</pubDate>
        
        <atom:modified>Sat, 22 May 2021 16:03:38 +0200</atom:modified>
        <guid>https://firminmartin.com/en/posts/2021/05/git_autocomplete_trailer_and_recipients_in_zsh/</guid>
        <description>Introduction When working on a Git repository developped through email-based workflow (e.g. Git, Linux kernel, Emacs, notmuch etc.), it is often needed
 to git commit with the --trailer option to acknowledge people, and to git send-email with the --to &amp;amp; -cc options to indicate the recipients of the patch series to send.  Newcomers of such workflow, as me, would copy one by one the email addresses from git-log or the project mailing list at the beginning.</description>
        <content:encoded>&lt;h2 id=&#34;introduction&#34;&gt;Introduction&lt;/h2&gt;
&lt;p&gt;When working on a Git repository developped through email-based workflow (&lt;em&gt;e.g.&lt;/em&gt;
Git, Linux kernel, Emacs, notmuch &lt;em&gt;etc.&lt;/em&gt;), it is often needed&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;to &lt;code&gt;git commit&lt;/code&gt; with the &lt;code&gt;--trailer&lt;/code&gt; option to acknowledge people,&lt;/li&gt;
&lt;li&gt;and to &lt;code&gt;git send-email&lt;/code&gt; with the &lt;code&gt;--to&lt;/code&gt; &amp;amp; &lt;code&gt;-cc&lt;/code&gt; options to indicate the
recipients of the patch series to send.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Newcomers of such workflow, as me, would copy one by one the email addresses
from &lt;code&gt;git-log&lt;/code&gt; or the project mailing list at the beginning. But it becomes
quickly tiresome. The good news is that this process can be automatized with
&lt;code&gt;fzf&lt;/code&gt; and &lt;code&gt;zsh&lt;/code&gt; (see the &lt;a href=&#34;#screencasts&#34;&gt;Screencasts&lt;/a&gt; section).&lt;/p&gt;
&lt;p&gt;Let&amp;rsquo;s make a fake Git repository to illustrate how it works.  The following
snippet will create at most 1500 empty commits from 150 distinct developers.
It uses &lt;code&gt;rig&lt;/code&gt;&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt; to create fake identities.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-zsh&#34; data-lang=&#34;zsh&#34;&gt;&lt;span class=&#34;nv&#34;&gt;DIR&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;~/tmp/Git_fzf/ mkdir -p &lt;span class=&#34;nv&#34;&gt;$DIR&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$DIR&lt;/span&gt;
git init
rig -c &lt;span class=&#34;m&#34;&gt;150&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; awk -v &lt;span class=&#34;nv&#34;&gt;RS&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;\n\n&amp;#39;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;{print $1 &amp;#34; &amp;#34; $2}&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;read&lt;/span&gt; name&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; i in &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;1..&lt;span class=&#34;k&#34;&gt;$((&lt;/span&gt; RANDOM &lt;span class=&#34;o&#34;&gt;%&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt;
            git commit --author &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$name&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; &amp;lt;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;// /.&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;@domain.com&amp;gt;&amp;#34;&lt;/span&gt; --allow-empty --allow-empty-message -m &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;a id=&#34;org6c6ada4&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;figure&gt;&lt;img src=&#34;https://firminmartin.com/ox-hugo/fake_repository.gif&#34;
         alt=&#34;Figure 1: Creating a fake Git repository with distinct authors.&#34;/&gt;&lt;figcaption&gt;
            &lt;p&gt;Figure 1: Creating a fake Git repository with distinct authors.&lt;/p&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;h2 id=&#34;fetching-email-addresses-of-developers&#34;&gt;Fetching email addresses of developers&lt;/h2&gt;
&lt;p&gt;The following command returns all email addresses of the current Git
repository&amp;rsquo;s developers.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-zsh&#34; data-lang=&#34;zsh&#34;&gt;git shortlog -sne --all &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; cut -f2
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Breaking it down, we instruct &lt;code&gt;git shortlog&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;to suppress commit descriptions (&lt;code&gt;-s&lt;/code&gt;),&lt;/li&gt;
&lt;li&gt;to sort the contributors by the number of commits (&lt;code&gt;-n&lt;/code&gt;),&lt;/li&gt;
&lt;li&gt;to provide contributors&#39; email (&lt;code&gt;-e&lt;/code&gt;),&lt;/li&gt;
&lt;li&gt;and to consider the developers of all branches (&lt;code&gt;--all&lt;/code&gt;).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Piping the result to &lt;code&gt;cut -f2&lt;/code&gt; helps us to get rid of the commits count.&lt;/p&gt;
&lt;h2 id=&#34;select-email-addresses&#34;&gt;Select email addresses&lt;/h2&gt;
&lt;p&gt;Now, we want to pick out some addresses we are interested in. This step requires
that the fuzzy filter &lt;a href=&#34;https://github.com/junegunn/fzf&#34;&gt;fzf&lt;/a&gt; is installed.&lt;/p&gt;
&lt;p&gt;It&amp;rsquo;s pretty simple: we just have to pipe the result of &lt;code&gt;git-shortlog&lt;/code&gt; to &lt;code&gt;fzf&lt;/code&gt; and
use the option &lt;code&gt;-m&lt;/code&gt; to enable multiple choices. The &lt;code&gt;--reverse&lt;/code&gt; option makes a
drop-down menu which I find less disruptive.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-zsh&#34; data-lang=&#34;zsh&#34;&gt;git shortlog -sne --all &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; cut -f2 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; fzf -m --reverse
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Now you can select/unselect emails with &lt;code&gt;TAB&lt;/code&gt; / &lt;code&gt;Shift+TAB&lt;/code&gt;. Once you
are done, press &lt;code&gt;RET&lt;/code&gt;. It will output the selected entries.&lt;/p&gt;
&lt;h2 id=&#34;select-git-commit-trailers-and-git-send-email-recipients-options&#34;&gt;Select &lt;code&gt;git-commit&lt;/code&gt; trailers and &lt;code&gt;git-send-email&lt;/code&gt; recipients options&lt;/h2&gt;
&lt;p&gt;We can also make a drop-down menu to select &lt;code&gt;git-commit&lt;/code&gt; trailers and
recipients options. Let&amp;rsquo;s wrap it in a function.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-zsh&#34; data-lang=&#34;zsh&#34;&gt;__fzf_git_trailer_and_option&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
cat &lt;span class=&#34;s&#34;&gt;&amp;lt;&amp;lt;- EOF | fzf --reverse
&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;	--to=
&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;	--bcc=
&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;	--cc=
&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;	--trailer Thanks-to:
&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;	--trailer Reviewed-by:
&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;	--trailer Reported-by:
&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;	--trailer Acked-by:
&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;	--trailer Tested-by:
&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;	--trailer Based-on-patch-by:
&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;	--trailer Mentored-by:
&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;	EOF&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;detect-if-we-are-under-a-git-repository&#34;&gt;Detect if we are under a Git repository&lt;/h2&gt;
&lt;p&gt;The command &lt;code&gt;git rev-parse --is-inside-work-tree&lt;/code&gt; can tell whether we are under
a Git repository. Let&amp;rsquo;s enable autocompletion only in such situation. We wrap
this into a function which, given a selected trailer or option and potentially
multiple addresses, returns addresses prefixed by the selected trailer or
option.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-zsh&#34; data-lang=&#34;zsh&#34;&gt;__fzf_git_authors&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;git rev-parse --is-inside-work-tree 2&amp;gt;/dev/null&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;then&lt;/span&gt;
    &lt;span class=&#34;nb&#34;&gt;local&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;trailer_or_option&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;__fzf_git_trailer_and_option&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;
    git shortlog -sne --all &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; cut -f2 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; fzf -m --reverse &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;read&lt;/span&gt; item&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt;
                &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; -n &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;trailer_or_option&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;item&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#39; &amp;#34;&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;
   &lt;span class=&#34;k&#34;&gt;fi&lt;/span&gt;
&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;bind-autocompletion-to-a-shortcut&#34;&gt;Bind autocompletion to a shortcut&lt;/h2&gt;
&lt;p&gt;So far, the result is outputted to the terminal, but we actually want that it
appends the current command line. So, we keep the content on the left of the
buffer and redisplay it.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-zsh&#34; data-lang=&#34;zsh&#34;&gt;fzf-git-authors&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;nv&#34;&gt;LBUFFER&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;LBUFFER&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;__fzf_git_authors&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;
  zle redisplay
  &lt;span class=&#34;nb&#34;&gt;typeset&lt;/span&gt; -f zle-line-init &amp;gt;/dev/null &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; zle zle-line-init
&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Finally, I bound that function to &lt;code&gt;Alt-E&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-zsh&#34; data-lang=&#34;zsh&#34;&gt;zle     -N   fzf-git-authors
bindkey &lt;span class=&#34;s1&#34;&gt;&amp;#39;\ee&amp;#39;&lt;/span&gt; fzf-git-authors
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;screencasts&#34;&gt;Screencasts&lt;/h2&gt;
&lt;figure&gt;&lt;img src=&#34;https://firminmartin.com/ox-hugo/git_commit.gif&#34;
         alt=&#34;Figure 2: git-commit with --trailer autocompletion.&#34;/&gt;&lt;figcaption&gt;
            &lt;p&gt;Figure 2: &lt;code&gt;git-commit&lt;/code&gt; with &lt;code&gt;--trailer&lt;/code&gt; autocompletion.&lt;/p&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;figure&gt;&lt;img src=&#34;https://firminmartin.com/ox-hugo/git_send_email.gif&#34;
         alt=&#34;Figure 3: git-send-email with recipients autocompletion.&#34;/&gt;&lt;figcaption&gt;
            &lt;p&gt;Figure 3: &lt;code&gt;git-send-email&lt;/code&gt; with recipients autocompletion.&lt;/p&gt;
        &lt;/figcaption&gt;
&lt;/figure&gt;

&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;On Ubuntu, &lt;code&gt;sudo apt install rig&lt;/code&gt;.&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</content:encoded>
        <dc:creator>[Firmin Martin]</dc:creator>
        
        
        
        
          
            
              <category>zsh</category>
            
          
            
              <category>git</category>
            
          
            
              <category>fzf</category>
            
          
            
              <category>autocomplete</category>
            
          
        
        
        
      </item>
      
      <item>
        <title>Rating images painlessly with exiftool feat. ranger &amp; sxiv</title>
        <link>https://firminmartin.com/en/posts/2020/12/rating_images_painlessly_with_exiftool/</link>
        <pubDate>Thu, 03 Dec 2020 00:00:00 +0100</pubDate>
        
        <atom:modified>Mon, 01 Mar 2021 09:47:12 +0100</atom:modified>
        <guid>https://firminmartin.com/en/posts/2020/12/rating_images_painlessly_with_exiftool/</guid>
        <description>Background I was looking for a way to classifying images by rating them on the fly. My first attempt was using darktable as suggested in a thread. Indeed, the auto-advance rating mechanism was quite handy. But it is still too heavy for this sole purpose. In darktable, user have to import images before editing metadata. When tens of thousands images are involved, the process of importing images can be quite time-consuming1 as it creates for each image an XMP file to store metadata.</description>
        <content:encoded>&lt;h2 id=&#34;background&#34;&gt;Background&lt;/h2&gt;
&lt;p&gt;I was looking for a way to classifying images by rating them on the fly.
My first attempt was using &lt;code&gt;darktable&lt;/code&gt; as suggested in &lt;a href=&#34;https://discuss.pixls.us/t/quick-rating-and-auto-advance-in-linux-a-la-photo-mechanic/3446&#34;&gt;a thread&lt;/a&gt;. Indeed, the
auto-advance rating mechanism was quite handy. But it is still
too heavy for this sole purpose. In &lt;code&gt;darktable&lt;/code&gt;, user have to import images before
editing metadata. When tens of thousands images are involved, the process of
importing images can be quite time-consuming&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt; as it creates for each image
an XMP file to store metadata. And this also applies to rating, even though I
configure it to improve performance (without OpenCL) the latency is counted by seconds.
Moreover, XMP are also created for symlink of image. This was not plausible
in my use-case&lt;sup id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt; as it enforces me to keep multiple metadata files for the same image.&lt;/p&gt;
&lt;p&gt;Lots of critics, but clearly &lt;code&gt;darktable&lt;/code&gt; was not the right tool. It suits
better on raw photo post-production as intended. I will present in this post two
solutions to remediate the issues aforementioned.&lt;/p&gt;
&lt;h2 id=&#34;goals&#34;&gt;Goals&lt;/h2&gt;
&lt;p&gt;After experiencing &lt;code&gt;darktable&lt;/code&gt;, I know better what I am seeking:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Edit metadata in the image file itself&lt;/strong&gt;. This has two advantages:
&lt;ol&gt;
&lt;li&gt;Keep metadata even if the filename is changed.&lt;/li&gt;
&lt;li&gt;Get rid of XMP files.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Preview and select image without latency&lt;/strong&gt;. Namely, preview images and rate them on the fly.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Metadata editing should follow symlink&lt;/strong&gt;. To centralize metadata in the same place.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Batch rating&lt;/strong&gt;. Rating a whole directory or multiple selected images at once.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;exiftool&#34;&gt;Exiftool&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://exiftool.org/&#34;&gt;ExifTool&lt;/a&gt; is a free and open-source software program for reading, writing, and
manipulating image, audio, video, and PDF metadata.&lt;/p&gt;
&lt;h3 id=&#34;rating-images-with-exiftool&#34;&gt;Rating images with exiftool&lt;/h3&gt;
&lt;p&gt;Rating image with exiftool is very simple.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;exiftool -rating&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; -overwrite_original_in_place &amp;lt;files&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;The option &lt;code&gt;-overwrite_original_in_place&lt;/code&gt; overwrite directly the file(s) instead
of moving the original one to &lt;code&gt;filename.ext_original&lt;/code&gt;. Use it wisely at your own risk.&lt;/p&gt;
&lt;p&gt;To read back the rating:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;exiftool -rating &amp;lt;files&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&amp;hellip; or format yourself the output:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;exiftool -p &lt;span class=&#34;s1&#34;&gt;&amp;#39;$Rating $Filepath&amp;#39;&lt;/span&gt; -f &amp;lt;files&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;And, of course the symbolic links are followed&lt;sup id=&#34;fnref:3&#34;&gt;&lt;a href=&#34;#fn:3&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;3&lt;/a&gt;&lt;/sup&gt;!&lt;/p&gt;
&lt;p&gt;But with exiftool alone, one cannot watch and rate image at the same time.
This can be done by combine up exiftool with a file manager having preview ability
or an image viewer. Next, I will show how to integrate exiftool capability in
the file manager &lt;code&gt;ranger&lt;/code&gt; and the image viewer &lt;code&gt;sxiv&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&#34;file-types-supported-by-exiftool&#34;&gt;File types supported by exiftool&lt;/h3&gt;
&lt;p&gt;In fact, the version &lt;code&gt;11.88&lt;/code&gt; of exiftool already supports a large set of file types.
Thus, what has been and will be said is not limited to images and rating.&lt;/p&gt;
&lt;div class=&#34;table-caption&#34;&gt;
  &lt;span class=&#34;table-number&#34;&gt;Table 1&lt;/span&gt;:
  File types supported by exiftool (v11.88) (r = read, w = write, c = create).
&lt;/div&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;3FR&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;DR4&lt;/code&gt;   (r/w/c)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ITC&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ODP&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;RIFF&lt;/code&gt;  (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;3G2&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;DSS&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;J2C&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ODS&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;RSRC&lt;/code&gt;  (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;3GP&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;DV&lt;/code&gt;    (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;JNG&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ODT&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;RTF&lt;/code&gt;   (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;A&lt;/code&gt;     (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;DVB&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;JP2&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;OFR&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;RW2&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;AA&lt;/code&gt;    (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;DVR&lt;/code&gt;-&lt;code&gt;MS&lt;/code&gt; (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;JPEG&lt;/code&gt;  (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;OGG&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;RWL&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;AAE&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;DYLIB&lt;/code&gt; (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;JSON&lt;/code&gt;  (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;OGV&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;RWZ&lt;/code&gt;   (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;AAX&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;EIP&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;K25&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;OPUS&lt;/code&gt;  (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;RM&lt;/code&gt;    (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;ACR&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;EPS&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;KDC&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ORF&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SEQ&lt;/code&gt;   (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;AFM&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;EPUB&lt;/code&gt;  (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;KEY&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;OTF&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SKETCH&lt;/code&gt; (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;AI&lt;/code&gt;    (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ERF&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;LA&lt;/code&gt;    (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PAC&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SO&lt;/code&gt;    (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;AIFF&lt;/code&gt;  (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;EXE&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;LFP&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PAGES&lt;/code&gt; (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SR2&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;APE&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;EXIF&lt;/code&gt;  (r/w/c)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;LNK&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PBM&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SRF&lt;/code&gt;   (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;ARQ&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;EXR&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;LRV&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PCD&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SRW&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;ARW&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;EXV&lt;/code&gt;   (r/w/c)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;M2TS&lt;/code&gt;  (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PCX&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SVG&lt;/code&gt;   (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;ASF&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;F4A&lt;/code&gt;, &lt;code&gt;F4V&lt;/code&gt; (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;M4A&lt;/code&gt;, &lt;code&gt;M4V&lt;/code&gt; (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PDB&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;SWF&lt;/code&gt;   (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;AVI&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;FFF&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;MAX&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PDF&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;THM&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;AVIF&lt;/code&gt;  (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;FITS&lt;/code&gt;  (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;MEF&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PEF&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;TIFF&lt;/code&gt;  (r/w)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;AZW&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;FLA&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;MIE&lt;/code&gt;   (r/w/c)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PFA&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;TORRENT&lt;/code&gt; (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;BMP&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;FLAC&lt;/code&gt;  (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;MIFF&lt;/code&gt;  (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PFB&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;TTC&lt;/code&gt;   (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;BPG&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;FLIF&lt;/code&gt;  (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;MKA&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PFM&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;TTF&lt;/code&gt;   (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;BTF&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;FLV&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;MKS&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PGF&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;TXT&lt;/code&gt;   (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;CHM&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;FPF&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;MKV&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PGM&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;VCF&lt;/code&gt;   (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;COS&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;FPX&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;MNG&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PLIST&lt;/code&gt; (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;VRD&lt;/code&gt;   (r/w/c)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;CR2&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;GIF&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;MOBI&lt;/code&gt;  (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PICT&lt;/code&gt;  (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;VSD&lt;/code&gt;   (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;CR3&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;GPR&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;MODD&lt;/code&gt;  (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PMP&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;WAV&lt;/code&gt;   (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;CRM&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;GZ&lt;/code&gt;    (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;MOI&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PNG&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;WDP&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;CRW&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;HDP&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;MOS&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PPM&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;WEBP&lt;/code&gt;  (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;CS1&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;HDR&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;MOV&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PPT&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;WEBM&lt;/code&gt;  (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;CSV&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;HEIC&lt;/code&gt;  (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;MP3&lt;/code&gt;   (r)&lt;sup id=&#34;fnref:4&#34;&gt;&lt;a href=&#34;#fn:4&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;4&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PPTX&lt;/code&gt;  (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;WMA&lt;/code&gt;   (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;DCM&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;HEIF&lt;/code&gt;  (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;MP4&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PS&lt;/code&gt;    (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;WMV&lt;/code&gt;   (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;DCP&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;HTML&lt;/code&gt;  (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;MPC&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PSB&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;WTV&lt;/code&gt;   (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;DCR&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ICC&lt;/code&gt;   (r/w/c)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;MPG&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PSD&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;WV&lt;/code&gt;    (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;DFONT&lt;/code&gt; (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ICS&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;MPO&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PSP&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;X3F&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;DIVX&lt;/code&gt;  (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;IDML&lt;/code&gt;  (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;MQV&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;QTIF&lt;/code&gt;  (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;XCF&lt;/code&gt;   (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;DJVU&lt;/code&gt;  (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;IIQ&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;MRW&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;R3D&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;XLS&lt;/code&gt;   (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;DLL&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;IND&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;MXF&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;RA&lt;/code&gt;    (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;XLSX&lt;/code&gt;  (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;DNG&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;INSP&lt;/code&gt;  (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;NEF&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;RAF&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;XMP&lt;/code&gt;   (r/w/c)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;DOC&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;INSV&lt;/code&gt;  (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;NRW&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;RAM&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ZIP&lt;/code&gt;   (r)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;DOCX&lt;/code&gt;  (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;INX&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;NUMBERS&lt;/code&gt; (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;RAR&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;DPX&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ISO&lt;/code&gt;   (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;O&lt;/code&gt;     (r)&lt;/td&gt;
&lt;td&gt;&lt;code&gt;RAW&lt;/code&gt;   (r/w)&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;ranger&#34;&gt;ranger&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/ranger/ranger/&#34;&gt;ranger&lt;/a&gt; is a free and open-source CLI files manager I&amp;rsquo;m using for years. It is very handy to select
images and preview them&lt;sup id=&#34;fnref:5&#34;&gt;&lt;a href=&#34;#fn:5&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;5&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;p&gt;Append the following snippet in &lt;code&gt;~/.config/ranger/commands.py&lt;/code&gt;.
It will add the custom command &lt;code&gt;rate_image &amp;lt;0-5&amp;gt; &amp;lt;files&amp;gt;&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# ~/.config/ranger/commands.py&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;rate_image&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&amp;#34;:rate_image &amp;lt;0-5&amp;gt; &amp;lt;files&amp;gt;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;    Command for rating image with exiftools.
&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;    &amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;

    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;execute&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;subprocess&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	    &lt;span class=&#34;n&#34;&gt;rating_score&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
	    &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fm&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;notify&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;rate_image: a rating score is required!&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;bad&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
	    &lt;span class=&#34;n&#34;&gt;files&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
	    &lt;span class=&#34;n&#34;&gt;cwd&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fm&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;thisdir&lt;/span&gt;
	    &lt;span class=&#34;n&#34;&gt;cf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fm&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;thisfile&lt;/span&gt;
	    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cwd&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;or&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
		&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fm&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;notify&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Error: no file selected for deletion!&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;bad&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;
	    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cwd&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;marked_items&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;files&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;join&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shell_escaped_basename&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;f&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cwd&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;marked_items&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
		&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fm&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mark_files&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;all&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;val&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
		&lt;span class=&#34;n&#34;&gt;files&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;cf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shell_escaped_basename&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;command&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;exiftool -rating=&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rating_score&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; \
		  &lt;span class=&#34;s2&#34;&gt;&amp;#34; -overwrite_original_in_place &amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;files&lt;/span&gt;
	&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fm&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;notify&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Run command: &amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;result&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fm&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;execute_command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;stdout&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;subprocess&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PIPE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;n&#34;&gt;stdout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;stderr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;result&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;communicate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;result&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;returncode&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
	    &lt;span class=&#34;c1&#34;&gt;# This is a generic function to print text in ranger.&lt;/span&gt;
	    &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fm&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;notify&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Succeeded to rate image &amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;files&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; \
			   &lt;span class=&#34;s2&#34;&gt;&amp;#34; with score &amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;rating_score&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;It remains to define some key bindings to be granted the full power of &lt;code&gt;ranger&lt;/code&gt;.
Append the following snippet to &lt;code&gt;~/.config/ranger/rc.conf&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-cfg&#34; data-lang=&#34;cfg&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# ~/.config/ranger/rc.conf&lt;/span&gt;
&lt;span class=&#34;na&#34;&gt;map r1 rate_image 1&lt;/span&gt;
&lt;span class=&#34;na&#34;&gt;map r2 rate_image 2&lt;/span&gt;
&lt;span class=&#34;na&#34;&gt;map r3 rate_image 3&lt;/span&gt;
&lt;span class=&#34;na&#34;&gt;map r4 rate_image 4&lt;/span&gt;
&lt;span class=&#34;na&#34;&gt;map r5 rate_image 5&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;The resulting workflow is as follows:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Select images with &lt;code&gt;SPC&lt;/code&gt; (single selection) or &lt;code&gt;v&lt;/code&gt; (reverse selection).&lt;/li&gt;
&lt;li&gt;Press &lt;code&gt;r&lt;/code&gt; and the rating &lt;code&gt;1&lt;/code&gt; to &lt;code&gt;5&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;figure&gt;&lt;img src=&#34;https://firminmartin.com/ox-hugo/ranger_rating.gif&#34;/&gt;
&lt;/figure&gt;

&lt;h2 id=&#34;sxiv&#34;&gt;sxiv&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/muennich/sxiv&#34;&gt;sxiv&lt;/a&gt; is a free, open-source, lightweight and scriptable image viewer.
Add the following entries in &lt;code&gt;~/.config/sxiv/exec/key-handler&lt;/code&gt;&lt;sup id=&#34;fnref:6&#34;&gt;&lt;a href=&#34;#fn:6&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;6&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# ~/.config/sxiv/exec/key-handler&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;case&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$1&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; in
&lt;span class=&#34;c1&#34;&gt;# ...&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;&amp;#34;C-1&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;      tr &lt;span class=&#34;s1&#34;&gt;&amp;#39;\n&amp;#39;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;\0&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; xargs -0 -I &lt;span class=&#34;o&#34;&gt;{}&lt;/span&gt; exiftool -rating&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; -overwrite_original_in_place &lt;span class=&#34;s2&#34;&gt;&amp;#34;{}&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;&amp;#34;C-2&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;      tr &lt;span class=&#34;s1&#34;&gt;&amp;#39;\n&amp;#39;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;\0&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; xargs -0 -I &lt;span class=&#34;o&#34;&gt;{}&lt;/span&gt; exiftool -rating&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; -overwrite_original_in_place &lt;span class=&#34;s2&#34;&gt;&amp;#34;{}&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;&amp;#34;C-3&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;      tr &lt;span class=&#34;s1&#34;&gt;&amp;#39;\n&amp;#39;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;\0&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; xargs -0 -I &lt;span class=&#34;o&#34;&gt;{}&lt;/span&gt; exiftool -rating&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; -overwrite_original_in_place &lt;span class=&#34;s2&#34;&gt;&amp;#34;{}&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;&amp;#34;C-4&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;      tr &lt;span class=&#34;s1&#34;&gt;&amp;#39;\n&amp;#39;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;\0&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; xargs -0 -I &lt;span class=&#34;o&#34;&gt;{}&lt;/span&gt; exiftool -rating&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; -overwrite_original_in_place &lt;span class=&#34;s2&#34;&gt;&amp;#34;{}&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt;
&lt;span class=&#34;s2&#34;&gt;&amp;#34;C-5&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;      tr &lt;span class=&#34;s1&#34;&gt;&amp;#39;\n&amp;#39;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;\0&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; xargs -0 -I &lt;span class=&#34;o&#34;&gt;{}&lt;/span&gt; exiftool -rating&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; -overwrite_original_in_place &lt;span class=&#34;s2&#34;&gt;&amp;#34;{}&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;;;&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;esac&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;The resulting workflow is as follows:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Open images with &lt;code&gt;sxiv&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Press &lt;code&gt;C-x C-&amp;lt;1..5&amp;gt;&lt;/code&gt; to rate the current image.&lt;/li&gt;
&lt;li&gt;Or mark images with &lt;code&gt;m&lt;/code&gt;&lt;sup id=&#34;fnref:7&#34;&gt;&lt;a href=&#34;#fn:7&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;7&lt;/a&gt;&lt;/sup&gt;, toggle thumbnails mode with &lt;code&gt;RET&lt;/code&gt; and press &lt;code&gt;C-x C-&amp;lt;1..5&amp;gt;&lt;/code&gt; to rate selected images.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;bonus&#34;&gt;Bonus&lt;/h2&gt;
&lt;p&gt;Some interesting tips are presented here.
The main dependencies are &lt;code&gt;zsh&lt;/code&gt; and &lt;code&gt;GNU parallel&lt;/code&gt;, adapt it
to fit your need.&lt;/p&gt;
&lt;h3 id=&#34;rate-or-view-images-of-specific-rating&#34;&gt;Rate or view images of specific rating&lt;/h3&gt;
&lt;p&gt;The long command below search all JPG files (potentially symlink) of rating 3, 4
or 5 and view them with &lt;code&gt;sxiv&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# 1. Find recursively all JPG under the current directory&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# 2. Use GNU parallel, for each JPG&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#    (a) noglob (zsh specific): disable zsh globing to prevent &amp;#34;No such file&amp;#34; error&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#    (b) Build the string &amp;#34;$Rating $Filepath&amp;#34;&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#    (c) Remove the last line of exiftool output which count the amounts of the files.&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#    (d) Keep entry with $Rating in {3, 4, 5}. Remove the first space.&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# 3. Use GNU parallel: view at most 250 found images with sxiv at a time.&lt;/span&gt;
find -L . -type f -regex &lt;span class=&#34;s2&#34;&gt;&amp;#34;.*\.jpg&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
parallel -L &lt;span class=&#34;m&#34;&gt;5000&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;s1&#34;&gt;&amp;#39;noglob exiftool -p &amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#39;&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;$Rating $Filepath&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#39;&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39; -f -q -q {} | \
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;   head --lines=-1 | \
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;   awk &amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#39;&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;$1 ~ /[345]/ {$1=&amp;#34;&amp;#34;; print substr($0, 2)}&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#39;&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
parallel -L &lt;span class=&#34;m&#34;&gt;250&lt;/span&gt; -q sxiv &lt;span class=&#34;s2&#34;&gt;&amp;#34;{}&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Some remarks:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;To see unrated images, use &lt;code&gt;-&lt;/code&gt; as rating, then you can rate them with &lt;code&gt;sxiv&lt;/code&gt; as above.&lt;/li&gt;
&lt;li&gt;This one-shot command is fast enough for hundreds of images. Above this amount, you may
want to take some time to dump the result in a file as follows.&lt;/li&gt;
&lt;/ul&gt;
&lt;!--listend--&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;find -L -type f -regex &lt;span class=&#34;s2&#34;&gt;&amp;#34;.*\.jpg&lt;/span&gt;$&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
parallel -L &lt;span class=&#34;m&#34;&gt;5000&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;noglob exiftool -p &amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#39;&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;$Rating $Filename&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#39;&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39; -f -q -q {} | \
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  head --lines=-1 | \
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  awk &amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#39;&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;$1 ~ /[^0-]/ {print $0}&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#39;&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt; &amp;gt;&amp;gt; ratingdb.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;And view images with specific rating with this command:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;awk &lt;span class=&#34;s1&#34;&gt;&amp;#39;$1 ~ /345/ {$1=&amp;#34;&amp;#34;; print substr($0, 2)}&amp;#39;&lt;/span&gt; ratingdb.txt &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
parallel -L &lt;span class=&#34;m&#34;&gt;250&lt;/span&gt; -q sxiv &lt;span class=&#34;s2&#34;&gt;&amp;#34;{}&amp;#34;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;The best would be writing a python script to maintain an SQLite database, and
adapt the script of ranger and sxiv above to update the database each time a
file rating changed.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;shuf&lt;/code&gt; may be used after &lt;code&gt;awk&lt;/code&gt; to shuffle images before viewing them.&lt;/li&gt;
&lt;li&gt;Actually, no one will type again and again those lengthy commands. I either
use &lt;code&gt;C-R&lt;/code&gt; in &lt;code&gt;zsh&lt;/code&gt; with &lt;a href=&#34;https://github.com/junegunn/fzf&#34;&gt;fzf&lt;/a&gt; for casual ones or add them as entries in &lt;a href=&#34;https://github.com/knqyf263/pet&#34;&gt;pet&lt;/a&gt;, a
manager of parametrizable snippet.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;migrate-xmp-rating-into-image-metadata&#34;&gt;Migrate XMP rating into image metadata&lt;/h3&gt;
&lt;p&gt;If you migrate from &lt;code&gt;darktable&lt;/code&gt; or have XMP files with rating, you can try the following commands.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;zmodload zsh/mapfile
&lt;span class=&#34;c1&#34;&gt;# 1. Find recursively all XMP under the current directory&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# 2. Use GNU parallel, for each XMP&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#   (a) Extract the rating with grep and awk; put it in $RATE.&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;#   (b) Append the image path to .xmp-$RATE-rating.db&lt;/span&gt;
find . -type f -regex &lt;span class=&#34;s2&#34;&gt;&amp;#34;.*\.xmp&amp;#34;&lt;/span&gt; -print0 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
parallel -0  &lt;span class=&#34;s1&#34;&gt;&amp;#39;TMP=$(grep -o &amp;#34;Rating=\&amp;#34;[012345]\&amp;#34;&amp;#34; {} | \
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  awk &amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#39;&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;{print gensub(/Rating=&amp;#34;([0-5])&amp;#34;/, &amp;#34;\1&amp;#34;, &amp;#34;g&amp;#34;, $1)}&amp;#39;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#39;&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;); \
&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;  echo {} &amp;gt;&amp;gt; xmp-$TMP-rating.db&amp;#39;&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;# 3. For each $RATE:&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; i in &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;1..5&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt;
    &lt;span class=&#34;nv&#34;&gt;FNAME&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;xmp-&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;-rating.db&amp;#34;&lt;/span&gt;
    &lt;span class=&#34;c1&#34;&gt;# For each file in .xmp-$RATE-rating.db&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; f in &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(f)mapfile[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$FNAME&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;do&lt;/span&gt;
	&lt;span class=&#34;c1&#34;&gt;# Use exiftool to rate it with the corresponding $RATE&lt;/span&gt;
	exiftool -rating&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$i&lt;/span&gt; -overwrite_original_in_place &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;%.*&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;Dozen hours for 950.000 images.&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:2&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;Statistical classification of images. For each class, it creates a directory in which each symbolic link is associated to the actual image.&amp;#160;&lt;a href=&#34;#fnref:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:3&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;Beware, without &lt;code&gt;-overwrite_original_in_place&lt;/code&gt;, &lt;a href=&#34;https://exiftool.org/forum/index.php?topic=6308.0&#34;&gt;symlink will be removed&lt;/a&gt;!&amp;#160;&lt;a href=&#34;#fnref:3&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:4&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;You may notice that you can&amp;rsquo;t write MP3 metadata. &lt;code&gt;ffmpeg&lt;/code&gt; should be used instead.&amp;#160;&lt;a href=&#34;#fnref:4&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:5&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;As long as you use the right terminal emulator, &lt;em&gt;e.g.&lt;/em&gt; iTerm, kitty, urxvt, xterm &lt;em&gt;etc.&lt;/em&gt; From my past experience, &lt;a href=&#34;https://github.com/elementary/terminal&#34;&gt;Elementary OS&amp;rsquo;s pantheon-terminal&lt;/a&gt; doesn&amp;rsquo;t work.&amp;#160;&lt;a href=&#34;#fnref:5&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:6&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;If this file doesn&amp;rsquo;t exist, you can copy the sample one: &lt;code&gt;mkdir -p ~/.config/sxiv/exec/ &amp;amp;&amp;amp; cp /usr/share/doc/sxiv/examples/key-handler .&lt;/code&gt;&amp;#160;&lt;a href=&#34;#fnref:6&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:7&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;See &lt;a href=&#34;https://github.com/muennich/sxiv/blob/master/config.def.h&#34;&gt;sxiv/config.def.h&lt;/a&gt; for more keybindings to mark images.&amp;#160;&lt;a href=&#34;#fnref:7&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</content:encoded>
        <dc:creator>[Firmin Martin]</dc:creator>
        
        
        
        
          
            
              <category>linux</category>
            
          
            
              <category>ranger</category>
            
          
            
              <category>exiftool</category>
            
          
            
              <category>zsh</category>
            
          
        
        
        
      </item>
      

    
  </channel>
</rss>
